<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SGPA & CGPA Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>SGPA & CGPA Calculator</h1>
    <p>Paste tab-separated or comma-separated data below (edit or replace the default data):</p>
    <textarea id="dataInput">
#	University Id	Student Name	Course Code	Course Name	Grade	Grade Point	Credits	Promotion	Reg Academic Year	Reg Sem
1	2200090186	CHINNABATTUNI RAKESH	21CC3002	AWS CERTIFIED SOLUTIONS ARCHITECT - ASSOCIATE	P	8	0	P	2024-2025	Even Sem
2	2200090186	CHINNABATTUNI RAKESH	21UC0013	GLOBAL LOGIC BUILDING CONTEST PRACTICUM	P	10	0	P	2023-2024	Odd Sem
3	2200090186	CHINNABATTUNI RAKESH	21UC0014	GLOBAL LOGIC BUILDING CONTEST PRACTICUM	P	10	0	P	2023-2024	Even Sem
4	2200090186	CHINNABATTUNI RAKESH	21UC0015	GLOBAL LOGIC BUILDING CONTEST PRACTICUM	P	10	0	P	2024-2025	Odd Sem
5	2200090186	CHINNABATTUNI RAKESH	22AD2001R	DATA DRIVEN ARTIFICIAL INTELLIGENT SYSTEMS	A+	9	3	P	2023-2024	Even Sem
6	2200090186	CHINNABATTUNI RAKESH	22AD2102A	DATABASE MANAGEMENT SYSTEMS	A+	9	5	P	2023-2024	Odd Sem
7	2200090186	CHINNABATTUNI RAKESH	22CI2001	ADAPTIVE SOFTWARE ENGINEERING	A	8	3	P	2023-2024	Odd Sem
8	2200090186	CHINNABATTUNI RAKESH	22CI2202A	CONTINUOUS DELIVERY AND DEVOPS	A+	9	6	P	2023-2024	Even Sem
9	2200090186	CHINNABATTUNI RAKESH	22CI2203	MANAGEMENT INFORMATION SYSTEMS	A	8	3	P	2024-2025	Odd Sem
10	2200090186	CHINNABATTUNI RAKESH	22CI3004R	ENTERPRISE PROGRAMMING	O	10	4	P	2024-2025	Odd Sem
11	2200090186	CHINNABATTUNI RAKESH	22CS2002R	AUTOMATA THEORY AND FORMAL LANGUAGES	A+	9	3	P	2023-2024	Even Sem
12	2200090186	CHINNABATTUNI RAKESH	22CS2103A	ADVANCED OBJECT ORIENTED PROGRAMMING	A+	9	6	P	2023-2024	Even Sem
13	2200090186	CHINNABATTUNI RAKESH	22CS2104R	OPERATING SYSTEMS	A	8	3	P	2023-2024	Odd Sem
14	2200090186	CHINNABATTUNI RAKESH	22CS2205R	DESIGN & ANALYSIS OF ALGORITHMS	A+	9	4	P	2023-2024	Odd Sem
15	2200090186	CHINNABATTUNI RAKESH	22CS2227	DATA ANALYTICS AND VISUALIZATION	A+	9	3	P	2023-2024	Even Sem
16	2200090186	CHINNABATTUNI RAKESH	22CS2233F	INTRODUCTION TO BLOCKCHAIN AND CRYPTO CURRENCIES	A+	9	3	P	2024-2025	Odd Sem
17	2200090186	CHINNABATTUNI RAKESH	22CVQ5SM	Coding & VQR Training	P	10	0	P	2024-2025	Odd Sem
18	2200090186	CHINNABATTUNI RAKESH	22EC1101	DIGITAL LOGIC AND PROCESSORS	A+	9	4	P	2022-2023	Odd Sem
19	2200090186	CHINNABATTUNI RAKESH	22EC1202	COMPUTER ORGANISATION AND ARCHITECTURE	A+	9	2	P	2022-2023	Even Sem
20	2200090186	CHINNABATTUNI RAKESH	22EC2210A	NETWORK PROTOCOLS & SECURITY	A	8	6	P	2023-2024	Odd Sem
21	2200090186	CHINNABATTUNI RAKESH	22IE2040	SOCIAL INTERNSHIP	P	9	0	P	2022-2023	Summer Term
22	2200090186	CHINNABATTUNI RAKESH	22IE3043	TERM PAPER	O	10	2	P	2024-2025	Even Sem
23	2200090186	CHINNABATTUNI RAKESH	22ME1103	DESIGN TOOL WORKSHOP	A+	9	2	P	2022-2023	Odd Sem
24	2200090186	CHINNABATTUNI Runs RAKESH	22MT0001	FUNDAMENTALS OF MATHEMATICS	O	10	3	P	2022-2023	Odd Sem
25	2200090186	CHINNABATTUNI RAKESH	22MT1101	MATHEMATICS FOR COMPUTING	A+	9	4.5	P	2022-2023	Odd Sem
26	2200090186	CHINNABATTUNI RAKESH	22MT2004	MATHEMATICAL PROGRAMMING	A+	9	4	P	2023-2024	Even Sem
27	2200090186	CHINNABATTUNI RAKESH	22MT2005	PROBABILITY, STATISTICS & QUEUEING THEORY	A+	9	4	P	2023-2024	Odd Sem
28	2200090186	CHINNABATTUNI RAKESH	22MT2102	MATHEMATICS FOR ENGINEERS	A+	9	3	P	2022-2023	Even Sem
29	2200090186	CHINNABATTUNI RAKESH	22PH4102	APPLIED PHYSICS	O	10	4	P	2024-2025	Even Sem
30	2200090186	CHINNABATTUNI RAKESH	22SC1101	COMPUTATIONAL THINKING FOR STRUCTURED DESIGN	A+	9	5.5	P	2022-2023	Odd Sem
31	2200090186	CHINNABATTUNI RAKESH	22SC1202	DATA STRUCTURES	A+	9	5	P	2022-2023	Even Sem
32	2200090186	CHINNABATTUNI RAKESH	22SC1203	COMPUTATIONAL THINKING FOR OBJECT ORIENTED DESIGN	A+	9	5	P	2022-2023	Even Sem
33	2200090186	CHINNABATTUNI RAKESH	22SC1209	IOT WORKSHOP	O	10	2	P	2022-2023	Even Sem
34	2200090186	CHINNABATTUNI RAKESH	22SDCI01A	PYTHON FULL STACK DEVELOPMENT WITH DJANGO	A+	9	4	P	2023-2024	Even Sem
35	2200090186	CHINNABATTUNI RAKESH	22SDCI05R	CLOUD DEVOPS	A+	9	2	P	2024-2025	Even Sem
36	2200090186	CHINNABATTUNI RAKESH	22SDCS01A	MERNSTACK WEB DEVELOPMENT	A+	9	4	P	2023-2024	Odd Sem
37	2200090186	CHINNABATTUNI RAKESH	22SDCS03R	JAVA FULL STACK DEVELOPMENT + MICROSERVICES	A	8	2	P	2024-2025	Odd Sem
38	2200090186	CHINNABATTUNI RAKESH	22SMD3101R	SOFTWARE VERIFICATION & VALIDATION	A+	9	4	P	2024-2025	Odd Sem
39	2200090186	CHINNABATTUNI RAKESH	22SMD3204M	SOFTWARE PROJECT MANAGEMENT	O	10	3	P	2024-2025	Odd Sem
40	2200090186	CHINNABATTUNI RAKESH	22SMD3308A	DOCKERS & CONTAINERIZATION	O	10	6	P	2024-2025	Even Sem
41	2200090186	CHINNABATTUNI RAKESH	22SP2102	BASKETBALL	P	7	0	P	2023-2024	Odd Sem
42	2200090186	CHINNABATTUNI RAKESH	22UC0021	SOCIAL IMMERSIVE LEARNING	O	10	1	P	2023-2024	Odd Sem
43	2200090186	CHINNABATTUNI RAKESH	22UC0022	SOCIAL IMMERSIVE LEARNING	O	10	1	P	2023-2024	Even Sem
44	2200090186	CHINNABATTUNI RAKESH	22UC0023	SOCIAL IMMERSIVE LEARNING	O	10	1	P	2024-2025	Odd Sem
45	2200090186	CHINNABATTUNI RAKESH	22UC0024	SOCIAL IMMERSIVE LEARNING	O	10	1	P	2024-2025	Even Sem
46	2200090186	CHINNABATTUNI RAKESH	22UC1101	Integrated Professional English	B+	7	2	P	2022-2023	Odd Sem
47	2200090186	CHINNABATTUNI RAKESH	22UC1202	ENGLISH PROFICIENCY	A	8	2	P	2022-2023	Even Sem
48	2200090186	CHINNABATTUNI RAKESH	22UC1203	DESIGN THINKING AND INNOVATION	O	10	2	P	2022-2023	Even Sem
49	2200090186	CHINNABATTUNI RAKESH	22UC2103	ESSENTIALS SKILLS FOR EMPLOYABILITY	A	8	2	P	2023-2024	Odd Sem
50	2200090186	CHINNABATTUNI RAKESH	22UC2204	CORPORATE READINESS SKILLS	A	8	2	P	2024-2025	Odd Sem
51	2200090186	CHINNABATTUNI RAKESH	22UC3108	PROBLEM SOLVING AND REASONING SKILLS-1	A	8	1	P	2023-2024	Even Sem
52	2200090186	CHINNABATTUNI RAKESH	22UC3209	PROBLEM SOLVING & REASONING SKILLS-2	O	10	1	P	2024-2025	Even Sem
53	2200090186	CHINNABATTUNI RAKESH	22UCCOD1	CAMPUS RECRUITMENT: LOGIC BUILDING SKILLS TRAINING (LEVEL-1)	P	10	0	P	2023-2024	Even Sem
54	2200090186	CHINNABATTUNI RAKESH	CRTCODL2V7	CAMPUS RECRUITMENT: CODING SKILLS TRAINING - DATA STRUCTURES	P	10	0	P	2024-2025	Even Sem
55	2200090186	CHINNABATTUNI RAKESH	CRTVQRL2V7	CAMPUS RECRUITMENT: QUANTITATIVE APTITUDE TRAINING	P	10	0	P	2024-2025	Even Sem
56	2200090186	CHINNABATTUNI RAKESH	OEGN0009	COMPETITIVE CODING TRAINING	P	9	0	P	2022-2023	Even Sem
    </textarea>
    <br>
    <button onclick="calculateGPA()">Calculate</button>
    <div id="error"></div>
    <div id="result"></div>
    <canvas id="sgpaChart"></canvas>
    <div id="course-details"></div>

    <script>
        // Grade to grade point mapping
        const gradePoints = {
            'O': 10,
            'A+': 9,
            'A': 8,
            'B+': 7,
            'B': 6,
            'C+': 5,
            'C': 4,
            'P': 0 // Ignored for calculations (0 credits)
        };

        function parseData(inputText) {
            const lines = inputText.trim().split('\n');
            const headers = lines[0].split('\t').map(h => h.trim());
            const requiredColumns = ['Reg Academic Year', 'Reg Sem', 'Credits', 'Grade', 'Course Name'];
            if (!requiredColumns.every(col => headers.includes(col))) {
                throw new Error('Input data must include columns: ' + requiredColumns.join(', '));
            }

            const data = [];
            for (let i = 1; i < lines.length; i++) {
                const values = lines[i].split('\t').map(v => v.trim());
                const row = {};
                headers.forEach((header, index) => {
                    row[header] = values[index] || '';
                });
                data.push(row);
            }
            return data;
        }

        function calculateGPA() {
            const dataInput = document.getElementById('dataInput').value;
            const errorDiv = document.getElementById('error');
            const resultDiv = document.getElementById('result');
            const courseDetailsDiv = document.getElementById('course-details');
            errorDiv.innerHTML = '';
            resultDiv.innerHTML = '';
            courseDetailsDiv.innerHTML = '';

            try {
                if (!dataInput.trim()) {
                    errorDiv.innerHTML = 'Please provide data in the text area.';
                    return;
                }

                const jsonData = parseData(dataInput);

                // Group data by academic year and semester
                const years = {};
                jsonData.forEach(row => {
                    const year = row['Reg Academic Year'] || 'Unknown Year';
                    const semester = row['Reg Sem'] || 'Unknown Sem';
                    const key = `${year} ${semester}`;
                    if (!years[year]) years[year] = {};
                    if (!years[year][semester]) years[year][semester] = [];
                    years[year][semester].push(row);
                });

                let totalCredits = 0;
                let totalGradePoints = 0;
                let tableHTML = '<table><tr><th>Academic Year</th><th>Semester</th><th>SGPA</th><th>Total Credits</th></tr>';
                let courseDetailsHTML = '<h2>Course Details</h2>';
                const chartData = { labels: [], sgpas: [], yearTotals: {}, yearCredits: {} };

                // Calculate SGPA for each semester and year
                for (const year in years) {
                    let yearCredits = 0;
                    let yearGradePoints = 0;

                    for (const semester in years[year]) {
                        let semesterCredits = 0;
                        let semesterGradePoints = 0;
                        courseDetailsHTML += `<h3>${year} ${semester}</h3><ul>`;

                        years[year][semester].forEach(course => {
                            const credits = parseFloat(course['Credits']);
                            const grade = course['Grade']?.toUpperCase();
                            const courseName = course['Course Name'] || 'Unknown Course';

                            courseDetailsHTML += `<li>${courseName}: Grade=${grade}, Credits=${credits}, Grade Point=${gradePoints[grade] || 'N/A'}</li>`;

                            if (!isNaN(credits) && credits > 0 && grade in gradePoints) {
                                semesterCredits += credits;
                                semesterGradePoints += credits * gradePoints[grade];
                            }
                        });

                        courseDetailsHTML += '</ul>';

                        if (semesterCredits > 0) {
                            const sgpa = (semesterGradePoints / semesterCredits).toFixed(2);
                            tableHTML += `<tr><td>${year}</td><td>${semester}</td><td>${sgpa}</td><td>${semesterCredits}</td></tr>`;
                            chartData.labels.push(`${year} ${semester}`);
                            chartData.sgpas.push(parseFloat(sgpa));
                            yearCredits += semesterCredits;
                            yearGradePoints += semesterGradePoints;
                            totalCredits += semesterCredits;
                            totalGradePoints += semesterGradePoints;
                        }
                    }

                    if (yearCredits > 0) {
                        chartData.yearTotals[year] = (yearGradePoints / yearCredits).toFixed(2);
                        chartData.yearCredits[year] = yearCredits;
                    }
                }

                // Calculate CGPA
                const cgpa = totalCredits > 0 ? (totalGradePoints / totalCredits).toFixed(2) : 'N/A';
                tableHTML += `<tr><td colspan="2"><b>CGPA</b></td><td><b>${cgpa}</b></td><td><b>${totalCredits}</b></td></tr>`;

                // Add yearly SGPA to table
                tableHTML += '<tr><th colspan="4">Yearly SGPA</th></tr>';
                for (const year in chartData.yearTotals) {
                    tableHTML += `<tr><td>${year}</td><td>All Semesters</td><td>${chartData.yearTotals[year]}</td><td>${chartData.yearCredits[year]}</td></tr>`;
                }
                tableHTML += '</table>';

                resultDiv.innerHTML = tableHTML;
                courseDetailsDiv.innerHTML = courseDetailsHTML;

                // Render SGPA chart
                const ctx = document.getElementById('sgpaChart').getContext('2d');
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: chartData.labels,
                        datasets: [{
                            label: 'SGPA per Semester',
                            data: chartData.sgpas,
                            backgroundColor: 'rgba(255, 51, 51, 0.6)', /* Red bars */
                            borderColor: '#000000', /* Black border */
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 10,
                                title: { display: true, text: 'SGPA', color: '#ffffff' },
                                ticks: { color: '#ffffff' } /* White ticks for dark theme */
                            },
                            x: {
                                title: { display: true, text: 'Semester', color: '#ffffff' },
                                ticks: { color: '#ffffff' } /* White ticks */
                            }
                        },
                        plugins: {
                            title: { display: true, text: 'SGPA by Semester', color: '#ff3333' } /* Red title */
                        }
                    }
                });
            } catch (error) {
                errorDiv.innerHTML = 'Error processing data: ' + error.message;
            }
        }
    </script>
</body>
</html>